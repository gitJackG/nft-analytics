
<div class="hourly-events-wrapper">
  <table class="hourly-events-table">
    <thead>
      <tr>
        <th>Hour</th>
        <th>Total Sales</th>
        <th>Total Orders</th>
        <th>Total Transfers</th>
        <th>Unique Senders</th>
        <th>Unique Receivers</th>
        <th>Latest Sender</th>
        <th>Latest Receiver</th>
        <th>Total Price (ETH)</th>
        <th>Latest Timestamp</th>
      </tr>
    </thead>

    <tbody>
      <% @results.each do |row| %>
        <tr>
          <td><%= row["hour"] %></td>
          <td><%= row["total_sales"] %></td>
          <td><%= row["total_orders"] %></td>
          <td><%= row["total_transfers"] %></td>
          <td><%= row["unique_senders"] %></td>
          <td><%= row["unique_receivers"] %></td>
          <td>
            <%= link_to truncate(row["latest_sender"], length: 10), "https://opensea.io/#{row["latest_sender"]}", target: "_blank", rel: "noopener", class: "sender-link"%>
          </td>
          <td>
            <%= link_to truncate(row["latest_receiver"], length: 10), "https://opensea.io/#{row["latest_receiver"]}", target: "_blank", rel: "noopener", class: "sender-link"%>
          </td>
          <td><%= number_with_precision(row["total_price"], precision: 2) %></td>
          <td><%= row["latest_timestamp"] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<br>
<br>
<div class="hourly-chart-wrapper">
  <%= line_chart @hourly_chart_data,
      xtitle: "Hour",
      ytitle: "Events",
      legend: "bottom",
      library: {
        plugins: {
          legend: {
            labels: { color: "#e5e7eb" }
          },
        },
        scales: {
          x: {
            type: "time",
            time: {
              unit: "hour",
              stepSize: 1,
              displayFormats: {
                hour: "HH:mm"
              }
            },
            title: { color: "#e5e7eb" },
            grid: { display: true, drawOnChartArea: true, drawTicks: true, drawBorder: false, color: "rgba(255,255,255,0.08)" },
            ticks: { color: "#9ca3af", autoSkip: false }
          },
          y: {
            title: { color: "#e5e7eb" },
            grid: { display: true, drawBorder: false, color: "rgba(255,255,255,0.08)" },
            ticks: { color: "#9ca3af" }
          }
        }
      }
  %>
</div>